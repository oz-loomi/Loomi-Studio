<script props>
  module.exports = {
    // Content
    label: props.label || '',
    value: props.value || '',
    caption: props.caption || '',
    // Layout
    align: props.align || 'center',
    padding: props.padding || '32px',
    // Typography
    font: props.font || "Helvetica Neue, Helvetica, Arial, sans-serif",
    // Label
    labelSize: props['label-size'] || '10px',
    labelWeight: props['label-weight'] || '700',
    labelSpacing: props['label-spacing'] || '2px',
    labelTransform: props['label-transform'] || 'uppercase',
    labelMargin: props['label-margin'] || '0 0 8px 0',
    // Value
    valueSize: props['value-size'] || '48px',
    valueWeight: props['value-weight'] || '700',
    valueLineHeight: props['value-line-height'] || '1',
    valueMargin: props['value-margin'] || '0 0 4px 0',
    // Caption
    captionSize: props['caption-size'] || '13px',
    captionWeight: props['caption-weight'] || '400',
    captionMargin: props['caption-margin'] || '0',
    // Colors
    bgColor: props['bg-color'] || '#ebebeb',
    radius: props.radius || '0',
    labelColor: props['label-color'] || '#494949',
    valueColor: props['value-color'] || '#cc0000',
    captionColor: props['caption-color'] || '#494949',
    // Border
    borderColor: props['border-color'] || '',
    borderWidth: props['border-width'] || '0px',
    borderStyle: props['border-style'] || 'none',
    // Per-side borders
    borderTopColor: props['border-top-color'] || '',
    borderTopWidth: props['border-top-width'] || '',
    borderTopStyle: props['border-top-style'] || '',
    borderRightColor: props['border-right-color'] || '',
    borderRightWidth: props['border-right-width'] || '',
    borderRightStyle: props['border-right-style'] || '',
    borderBottomColor: props['border-bottom-color'] || '',
    borderBottomWidth: props['border-bottom-width'] || '',
    borderBottomStyle: props['border-bottom-style'] || '',
    borderLeftColor: props['border-left-color'] || '',
    borderLeftWidth: props['border-left-width'] || '',
    borderLeftStyle: props['border-left-style'] || '',
    get borderCss() {
      const sides = [
        { s: 'top', c: this.borderTopColor, w: this.borderTopWidth, st: this.borderTopStyle },
        { s: 'right', c: this.borderRightColor, w: this.borderRightWidth, st: this.borderRightStyle },
        { s: 'bottom', c: this.borderBottomColor, w: this.borderBottomWidth, st: this.borderBottomStyle },
        { s: 'left', c: this.borderLeftColor, w: this.borderLeftWidth, st: this.borderLeftStyle },
      ];
      const perSide = sides.filter(x => x.c).map(x => ' border-' + x.s + ': ' + (x.w || this.borderWidth || '1px') + ' ' + (x.st || this.borderStyle || 'solid') + ' ' + x.c + ';').join('');
      if (perSide) return perSide;
      return this.borderColor ? ' border: ' + this.borderWidth + ' ' + this.borderStyle + ' ' + this.borderColor + ';' : '';
    },
    // Structured gradient
    gradientType: props['gradient-type'] || 'none',
    gradientAngle: props['gradient-angle'] || '',
    gradientDirection: props['gradient-direction'] || 'to bottom',
    gradientStart: props['gradient-start'] || '',
    gradientStartPosition: props['gradient-start-position'] || '0',
    gradientEnd: props['gradient-end'] || '',
    gradientEndPosition: props['gradient-end-position'] || '100',
    get gradientCss() {
      if (this.gradientType === 'none' || !this.gradientStart || !this.gradientEnd) return '';
      const startPos = this.gradientStartPosition === '' ? '0' : this.gradientStartPosition;
      const endPos = this.gradientEndPosition === '' ? '100' : this.gradientEndPosition;
      const startStop = this.gradientStart + ' ' + startPos + '%';
      const endStop = this.gradientEnd + ' ' + endPos + '%';
      if (this.gradientType === 'radial') return ' background: radial-gradient(circle, ' + startStop + ', ' + endStop + ');';
      const axis = this.gradientAngle !== '' ? (this.gradientAngle + 'deg') : this.gradientDirection;
      return ' background: linear-gradient(' + axis + ', ' + startStop + ', ' + endStop + ');';
    },
    // ── Mobile overrides (responsive) ──
    mValueSize: props['m:value-size'] || '',
    mAlign: props['m:align'] || '',
    mRadius: props['m:radius'] || '',
    mPadding: props['m:padding'] || '',
    scopeClass: 'loomi-c' + (props['component-index'] || '0'),
    get responsiveCss() {
      const r = [];
      const s = '.' + this.scopeClass + ' ';
      if (this.mValueSize) r.push(s + '.loomi-cs-value { font-size: ' + this.mValueSize + ' !important; }');
      if (this.mAlign) r.push(s + '.loomi-cs-td { text-align: ' + this.mAlign + ' !important; }');
      if (this.mRadius) r.push(s + '.loomi-cs-table { border-radius: ' + this.mRadius + ' !important; }');
      if (this.mPadding) r.push(s + '.loomi-cs-td { padding: ' + this.mPadding + ' !important; }');
      return r.join(' ');
    },
  };
</script>

<if condition="responsiveCss">
  <style>
    @media screen and (max-width: 600px) {
      {{{ responsiveCss }}}
    }
  </style>
</if>

<tr class="{{ scopeClass }}">
  <td>
    <table
      role="presentation"
      width="100%"
      cellspacing="0"
      cellpadding="0"
      border="0"
      class="loomi-cs-table"
      style="background-color: {{ bgColor }};{{ gradientCss }} border-radius: {{ radius }};{{ borderCss }}"
    >
      <tr>
        <td class="loomi-cs-td" style="padding: {{ padding }}; text-align: {{ align }};">
          <if condition="label">
            <p style="font-family: {{ font }}; font-size: {{ labelSize }}; font-weight: {{ labelWeight }}; letter-spacing: {{ labelSpacing }}; text-transform: {{ labelTransform }}; color: {{ labelColor }}; margin: {{ labelMargin }};">
              {{ label }}
            </p>
          </if>
          <p class="loomi-cs-value" style="font-family: {{ font }}; font-size: {{ valueSize }}; font-weight: {{ valueWeight }}; line-height: {{ valueLineHeight }}; color: {{ valueColor }}; margin: {{ valueMargin }};">
            {{ value }}
          </p>
          <if condition="caption">
            <p style="font-family: {{ font }}; font-size: {{ captionSize }}; font-weight: {{ captionWeight }}; color: {{ captionColor }}; margin: {{ captionMargin }};">
              {{ caption }}
            </p>
          </if>
        </td>
      </tr>
    </table>
  </td>
</tr>
