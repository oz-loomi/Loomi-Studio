<script props>
  module.exports = {
    rooftop: props.rooftop || '',
    // Background
    bgColor: props['bg-color'] || '',
    bgImage: props['bg-image'] || '',
    // Content
    greeting: props.greeting || '',
    body: props.body || props.copy || '',
    // Layout
    align: props.align || props['text-align'] || 'left',
    padding: props.padding || '',
    // Typography
    font: props.font || "Helvetica Neue, Helvetica, Arial, sans-serif",
    // Greeting
    greetingSize: props['greeting-size'] || '14px',
    greetingWeight: props['greeting-weight'] || '400',
    greetingSpacing: props['greeting-spacing'] || 'normal',
    greetingTransform: props['greeting-transform'] || 'none',
    greetingMargin: props['greeting-margin'] || '0 0 16px 0',
    greetingColor: props['greeting-color'] || '#000000',
    // Body
    bodySize: props['body-size'] || '16px',
    bodyWeight: props['body-weight'] || '400',
    bodyMargin: props['body-margin'] || '0',
    bodyColor: props['body-color'] || '#222222',
    lineHeight: props['line-height'] || '1.8',
    // Border
    borderColor: props['border-color'] || '',
    borderWidth: props['border-width'] || '0px',
    borderStyle: props['border-style'] || 'none',
    // Per-side borders
    borderTopColor: props['border-top-color'] || '',
    borderTopWidth: props['border-top-width'] || '',
    borderTopStyle: props['border-top-style'] || '',
    borderRightColor: props['border-right-color'] || '',
    borderRightWidth: props['border-right-width'] || '',
    borderRightStyle: props['border-right-style'] || '',
    borderBottomColor: props['border-bottom-color'] || '',
    borderBottomWidth: props['border-bottom-width'] || '',
    borderBottomStyle: props['border-bottom-style'] || '',
    borderLeftColor: props['border-left-color'] || '',
    borderLeftWidth: props['border-left-width'] || '',
    borderLeftStyle: props['border-left-style'] || '',
    get borderCss() {
      const sides = [
        { s: 'top', c: this.borderTopColor, w: this.borderTopWidth, st: this.borderTopStyle },
        { s: 'right', c: this.borderRightColor, w: this.borderRightWidth, st: this.borderRightStyle },
        { s: 'bottom', c: this.borderBottomColor, w: this.borderBottomWidth, st: this.borderBottomStyle },
        { s: 'left', c: this.borderLeftColor, w: this.borderLeftWidth, st: this.borderLeftStyle },
      ];
      const perSide = sides.filter(x => x.c).map(x => ' border-' + x.s + ': ' + (x.w || this.borderWidth || '1px') + ' ' + (x.st || this.borderStyle || 'solid') + ' ' + x.c + ';').join('');
      if (perSide) return perSide;
      return this.borderColor ? ' border: ' + this.borderWidth + ' ' + this.borderStyle + ' ' + this.borderColor + ';' : '';
    },
    // ── Mobile overrides (responsive) ──
    mGreetingSize: props['m:greeting-size'] || '',
    mBodySize: props['m:body-size'] || '',
    mLineHeight: props['m:line-height'] || '',
    mAlign: props['m:align'] || '',
    mPadding: props['m:padding'] || '',
    scopeClass: 'loomi-c' + (props['component-index'] || '0'),
    get responsiveCss() {
      const r = [];
      const s = '.' + this.scopeClass + ' ';
      if (this.mGreetingSize) r.push(s + '.loomi-greeting { font-size: ' + this.mGreetingSize + ' !important; }');
      if (this.mBodySize) r.push(s + '.loomi-body { font-size: ' + this.mBodySize + ' !important; }');
      if (this.mLineHeight) r.push(s + '.loomi-body { line-height: ' + this.mLineHeight + ' !important; }');
      if (this.mAlign) r.push(s + '.loomi-copy-td { text-align: ' + this.mAlign + ' !important; }');
      if (this.mPadding) r.push(s + '.loomi-copy-td { padding: ' + this.mPadding + ' !important; }');
      return r.join(' ');
    },
  };
</script>

<if condition="responsiveCss">
  <style>
    @media screen and (max-width: 600px) {
      {{{ responsiveCss }}}
    }
  </style>
</if>

<tr class="{{ scopeClass }}">
  <td class="loomi-copy-td" style="text-align: {{ align }};{{ padding ? ' padding: ' + padding + ';' : '' }}{{ bgColor ? ' background-color: ' + bgColor + ';' : '' }}{{ bgImage ? ' background-image: url(' + bgImage + '); background-size: cover; background-position: center;' : '' }}{{ borderCss }}">
    <if condition="greeting">
      <p class="loomi-greeting" style="font-family: {{ font }}; font-size: {{ greetingSize }}; font-weight: {{ greetingWeight }}; letter-spacing: {{ greetingSpacing }}; text-transform: {{ greetingTransform }}; color: {{ greetingColor }}; margin: {{ greetingMargin }};">
        {{ greeting }}
      </p>
    </if>
    <p class="loomi-body" style="font-family: {{ font }}; font-size: {{ bodySize }}; font-weight: {{ bodyWeight }}; color: {{ bodyColor }}; margin: {{ bodyMargin }}; line-height: {{ lineHeight }};">
      {{{ body }}}
    </p>
  </td>
</tr>
