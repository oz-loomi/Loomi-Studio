<script props>
  module.exports = {
    rooftop: props.rooftop || '',
    // Content
    image: props.image || '',
    imageAlt: props['image-alt'] || '',
    heading: props.heading || '',
    description: props.description || '',
    buttonText: props['button-text'] || '',
    buttonUrl: props['button-url'] || '#',
    utmCampaign: props['utm-campaign'] || '',
    // Background
    bgSize: props['bg-size'] || 'cover',
    bgPosition: props['bg-position'] || 'center center',
    // Overlay
    overlay: props.overlay || 'medium',
    customOverlay: props['custom-overlay'] || '',
    get overlayGradient() {
      if (this.customOverlay) return this.customOverlay;
      const overlays = {
        light: 'linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.4) 40%, rgba(0,0,0,0) 100%)',
        medium: 'linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.6) 40%, rgba(0,0,0,0) 100%)',
        dark: 'linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.8) 50%, rgba(0,0,0,0.3) 100%)',
        heavy: 'linear-gradient(to top, rgba(0,0,0,1) 0%, rgba(0,0,0,0.9) 50%, rgba(0,0,0,0.5) 100%)',
      };
      return overlays[this.overlay] || overlays.medium;
    },
    get fullUrl() {
      if (!this.utmCampaign) return this.buttonUrl;
      return this.buttonUrl + '?utm_source=email&utm_medium=lifecycle&utm_campaign=' + this.utmCampaign;
    },
    // Layout
    contentPadding: props['content-padding'] || '200px 48px 48px 48px',
    align: props.align || 'left',
    // Typography
    font: props.font || "Helvetica Neue, Helvetica, Arial, sans-serif",
    // Heading
    headingSize: props['heading-size'] || '28px',
    headingWeight: props['heading-weight'] || '700',
    headingLineHeight: props['heading-line-height'] || '1.2',
    headingMargin: props['heading-margin'] || '0 0 16px 0',
    headingColor: props['heading-color'] || '#ffffff',
    // Description
    descSize: props['desc-size'] || '15px',
    descWeight: props['desc-weight'] || '400',
    descLineHeight: props['desc-line-height'] || '1.7',
    descMargin: props['desc-margin'] || '0 0 28px 0',
    descColor: props['description-color'] || 'rgba(255,255,255,0.85)',
    // Button
    btnFontSize: props['btn-font-size'] || '12px',
    btnFontWeight: props['btn-font-weight'] || '700',
    btnLetterSpacing: props['btn-letter-spacing'] || '2px',
    btnTransform: props['btn-transform'] || 'uppercase',
    btnPadding: props['btn-padding'] || '16px 36px',
    btnBgColor: props['button-bg-color'] || '#ffffff',
    btnTextColor: props['button-text-color'] || '#000000',
    btnRadius: props['button-radius'] || '0',
    btnBorder: props['button-border'] || '',
    // Border
    borderColor: props['border-color'] || '',
    borderWidth: props['border-width'] || '0px',
    borderStyle: props['border-style'] || 'none',
  };
</script>

<!--[if mso]>
<v:rect xmlns:v="urn:schemas-microsoft-com:vml" fill="true" stroke="false" style="width:600px;">
<v:fill type="frame" src="{{ image }}" />
<v:textbox style="mso-fit-shape-to-text:true" inset="0,0,0,0">
<![endif]-->
<tr>
  <td style="{{ borderColor ? 'border: ' + borderWidth + ' ' + borderStyle + ' ' + borderColor + ';' : '' }}">
    <div style="background-image: url('{{ image }}'); background-size: {{ bgSize }}; background-position: {{ bgPosition }};">
      <div style="background: {{ overlayGradient }};">
        <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td class="mobile-padding" style="padding: {{ contentPadding }}; text-align: {{ align }};">
              <if condition="heading">
                <h2 style="font-family: {{ font }}; font-size: {{ headingSize }}; font-weight: {{ headingWeight }}; line-height: {{ headingLineHeight }}; color: {{ headingColor }}; margin: {{ headingMargin }};">
                  {{ heading }}
                </h2>
              </if>
              <if condition="description">
                <p style="font-family: {{ font }}; font-size: {{ descSize }}; font-weight: {{ descWeight }}; line-height: {{ descLineHeight }}; color: {{ descColor }}; margin: {{ descMargin }};">
                  {{ description }}
                </p>
              </if>
              <if condition="buttonText">
                <a
                  href="{{ fullUrl }}"
                  target="_blank"
                  style="display: inline-block; background-color: {{ btnBgColor }}; border-radius: {{ btnRadius }}; color: {{ btnTextColor }}; font-family: {{ font }}; font-size: {{ btnFontSize }}; font-weight: {{ btnFontWeight }}; letter-spacing: {{ btnLetterSpacing }}; text-decoration: none; text-transform: {{ btnTransform }}; padding: {{ btnPadding }};{{ btnBorder ? ' border: ' + btnBorder + ';' : '' }}"
                >
                  {{ buttonText }}
                </a>
              </if>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </td>
</tr>
<!--[if mso]>
</v:textbox>
</v:rect>
<![endif]-->
